---
title: "a3_results"
author: "James Bao"
date: "10/18/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# install.packages('tidyverse')
# install.packages("sjstats")
# install.packages("ROCR")
# install.packages("brms")
# install.packages("modelr")
# install.packages("nnet")
# install.packages("tidybayes")
require(nnet)
library(tidyverse) # for data manipulation and plots
```

```{r}
# load the csv, can be downloaded via utoronto
poll <- as_tibble(data.frame(read_csv("gss_cleaned.csv"))) 

# choose pertinent variables
poll <- poll %>% select(age, sex, marital_status,self_rated_health, 
                        total_children, self_rated_mental_health)

# clean up the data
poll<-poll[!grepl("Don't know", poll$self_rated_mental_health),]

# poll <- head(poll, 1000)

```
```{r}
nrow(poll)

# table(poll$age)
table(poll$sex)
table(poll$marital_status)
table(poll$self_rated_mental_health)
```


```{r}


model <- multinom(self_rated_mental_health ~ age + sex + marital_status +self_rated_health, 
                  data = poll)
summary(model)
```


```{r}
head(fitted(model))

input <- data.frame(self_rated_health = c("Excellent"), age = c(21.5), sex = c("Male"), marital_status = c("Single, never married"))
predict(model, newdata = input, "probs")
```

# Results

By using the Canadian General Social survey collected in 2017 about Family, we were able to access over 20000 responses. 

As explained in the previous section, we modeled the a persons self reported mental health against several variables such as age, sex, marital status, and self rated physical health in order to gain more insight on this topic. By analyzing the summary statistic of our model shown in figure N, we can see the various results in relation to our baseline which was chosen to be self_reported_mental_health = "Excellent". By analyzing the summary table, we can notice certain variables and their affect on a persons self rating of their mental health. For example, having a married marital status decreases your log odds having an poor self reported mental health compared to an excellent self assessment by 0.92. However, being married has a much smaller affect on the odds of having fair mental health self assessment and close to no affect on Good and Very good self reported mental health in comparison to an excellent self assessment. More noticeably, the strongest correlation is found between self rated physical health and self rated mental health. An individual marking themselves as excellent physical health decreases their log chances of being in poor mental health by 5. Variables such as age as almost no affect on a persons mental health rating. 


```{r}
total_survey = nrow(poll)
bar_sex <- data.frame(table(poll$sex)) %>%
  rename(
    Sex = Var1,
    Total = Freq
  )
ggplot(bar_sex, aes(x = Sex, y = Total/total_survey)) + 
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(round(Total/total_survey*100), "%")),
            color="white",
            position = position_stack(vjust = 0.5)) + 
  ggtitle("Percentage of sex") + 
  scale_y_continuous("Number of People")

```

```{r}
ggplot(poll, aes(x=age)) + geom_histogram(position="identity", binwidth = 10)
mean(poll$age)
```

```{r}
total_survey = nrow(poll)
bar_sex <- data.frame(table(poll$self_rated_mental_health)) %>%
  rename(
    Mental_Health = Var1,
    Total = Freq
  )
ggplot(bar_sex, aes(x = Mental_Health, y = Total/total_survey)) + 
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(round(Total/total_survey*100), "%")),
            color="white",
            position = position_stack(vjust = 0.5)) + 
  ggtitle("Respondents self rated mental health") + 
  scale_y_continuous("Number of People")
```




